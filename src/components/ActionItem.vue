<template>
    <div class="v-action-item pointer-element" @click="handleItemClick">
        <svg v-if="type === 'demand'" class="icon icon-demand" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M825.80468748 649.08211189l20.19597159 58.89708816a23.54631039 23.54631039 0 0 1-23.85942684 23.20188285h-119.29713196a23.54631039 23.54631039 0 0 1-23.85942684-23.20188285l20.1959716-58.89708816c-40.86161619-15.81234907-77.62141521-46.05933927-107.55528897-84.50996379C639.65732507 481.43989446 668.5579162 382.37004518 668.5579162 287.58988294c0-60.11823955-11.83577848-112.09546805-32.56404637-156.37004744C673.16071969 113.8732186 716.30808095 104.94941699 762.4926668 104.94941699c138.33457546 0 250.4926668 78.21633481 250.4926657 231.92489743 0 129.37946167-79.56273277 270.5947029-187.18064502 312.20779747z m-425.71228566 28.24304825L418.0652505 731.1810829a31.06109074 31.06109074 0 0 1-21.01007324 29.24501867c37.01029108 16.43858086 85.6058686 29.68338059 149.16838353 33.84782215 100.82329807 6.60674432 169.14517305 35.22553119 203.18086395 85.01094789 36.44668259 53.48018414 17.50317457 109.84103406 16.65776181 112.22071464a32.25093103 32.25093103 0 0 1-40.54849973 19.47580541 30.99846745 30.99846745 0 0 1-19.94547844-39.57784152c0.28180425-0.90803603 9.4874101-30.56010554-9.86314873-58.17692201-22.3564701-31.96912678-75.5235389-51.53886658-153.73987482-56.67396524-130.25618661-8.54806188-208.66039128-51.69542425-254.97022258-94.05999609H230.1957504a31.3115828 31.3115828 0 0 1-31.3115828-31.3115839l17.94153649-53.85592276C97.43463774 618.05233223 11.0146675 451.22421647 11.0146675 298.04795127 11.0146675 107.83008278 144.18283098 11.0146675 308.4747085 11.0146675S605.9347495 107.83008278 605.9347495 298.04795127c0 153.1762652-86.41997025 320.00438096-205.84234768 379.27720887z" p-id="5650"></path><path d="M825.80468748 649.08211189l20.19597159 58.89708816a23.54631039 23.54631039 0 0 1-23.85942684 23.20188285h-119.29713196a23.54631039 23.54631039 0 0 1-23.85942684-23.20188285l20.1959716-58.89708816c-40.86161619-15.81234907-77.62141521-46.05933927-107.55528897-84.50996379C639.65732507 481.43989446 668.5579162 382.37004518 668.5579162 287.58988294c0-60.11823955-11.83577848-112.09546805-32.56404637-156.37004744C673.16071969 113.8732186 716.30808095 104.94941699 762.4926668 104.94941699c138.33457546 0 250.4926668 78.21633481 250.4926657 231.92489743 0 129.37946167-79.56273277 270.5947029-187.18064502 312.20779747z m-425.71228566 28.24304825L418.0652505 731.1810829a31.06109074 31.06109074 0 0 1-21.01007324 29.24501867c37.01029108 16.43858086 85.6058686 29.68338059 149.16838353 33.84782215 100.82329807 6.60674432 169.14517305 35.22553119 203.18086395 85.01094789 36.44668259 53.48018414 17.50317457 109.84103406 16.65776181 112.22071464a32.25093103 32.25093103 0 0 1-40.54849973 19.47580541 30.99846745 30.99846745 0 0 1-19.94547844-39.57784152c0.28180425-0.90803603 9.4874101-30.56010554-9.86314873-58.17692201-22.3564701-31.96912678-75.5235389-51.53886658-153.73987482-56.67396524-130.25618661-8.54806188-208.66039128-51.69542425-254.97022258-94.05999609H230.1957504a31.3115828 31.3115828 0 0 1-31.3115828-31.3115839l17.94153649-53.85592276C97.43463774 618.05233223 11.0146675 451.22421647 11.0146675 298.04795127 11.0146675 107.83008278 144.18283098 11.0146675 308.4747085 11.0146675S605.9347495 107.83008278 605.9347495 298.04795127c0 153.1762652-86.41997025 320.00438096-205.84234768 379.27720887z"></path></svg>
        <svg v-else-if="type === 'ui'" class="icon icon-ui" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M904.036174 0H119.340522C53.670957 0 0 51.066435 0 116.758261v784.65113C0 967.190261 53.670957 1024 119.340522 1024h784.695652C969.728 1024 1024 967.190261 1024 901.409391V116.758261C1024 51.066435 969.728 0 904.036174 0z m-285.829565 163.59513a153.86713 153.86713 0 1 1 0 307.667479 153.86713 153.86713 0 0 1 0-307.667479z m269.668174 667.492174c-6.522435 12.087652-19.144348 14.825739-32.857044 14.825739H182.694957c-11.820522 0-22.950957-0.823652-30.007653-10.306782-7.056696-9.527652-9.193739-19.389217-5.765565-30.742261l96.189218-317.017043c6.344348-20.925217 24.019478-35.84 45.612521-39.424a57.700174 57.700174 0 0 1 56.008348 23.663304l134.477913 189.061565a57.299478 57.299478 0 0 0 78.937044 14.291478l123.814956-84.079304a57.344 57.344 0 0 1 80.250435 16.13913l124.126609 187.770435c7.479652 11.50887 8.102957 23.774609 1.536 35.817739z"></path></svg>
        <svg v-else-if="type === 'api'" class="icon icon-api" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M1013.64221577 62.90842351l-52.42699041-52.42699041c-1.97837653-1.97837653-4.45134854-2.84391645-7.04796833-2.84391754s-5.06959073 0.98918881-7.04796725 2.84391754l-94.09655608 94.09655499a246.39448945 246.39448945 0 0 0-138.61003817-42.41145673c-63.308064 0-126.61612691 24.11146927-174.96271432 72.45805773L413.45209648 260.62247382a9.92897968 9.92897968 0 0 0 0 13.9722878L749.40523838 610.54790352c1.97837653 1.97837653 4.45134854 2.84391645 7.04796833 2.84391754 2.47297093 0 5.06959073-0.98918881 7.04796834-2.84391754l125.99788472-125.99788473c85.19385899-85.31750786 95.20939266-217.25052326 30.04659992-313.44910362l94.09655608-94.09655607c3.83310527-3.95675414 3.83310527-10.26283033 0-14.09593559zM594.72088806 554.90605113a9.92897968 9.92897968 0 0 0-13.9722878 0L498.39865773 637.25599366 386.74400634 525.60134227l82.4735914-82.4735914c3.83310527-3.83310527 3.83310527-10.13918254 0-13.9722878L424.20952121 384.14738653a9.92897968 9.92897968 0 0 0-13.9722878 0L327.76364308 466.62097794l-53.16888146-53.16888146a9.70641257 9.70641257 0 0 0-7.04796833-2.84391754c-2.47297093 0-5.06959073 0.98918881-7.04796834 2.84391754L134.62458909 539.44998121c-85.19385899 85.19385899-95.20939266 217.25052326-30.046601 313.44910362l-94.09655499 94.09655607a9.92897968 9.92897968 0 0 0 0 13.97228781l52.42699041 52.42698931c1.97837653 1.97837653 4.45134854 2.84391645 7.04796725 2.84391755s5.06959073-0.98918881 7.04796834-2.84391755l94.09655607-94.09655498c41.66956566 28.31552114 90.13980194 42.41145673 138.61003711 42.41145673 63.308064 0 126.61612691-24.11146927 174.96271539-72.45805774l125.99788473-125.99788474c3.83310527-3.83310527 3.83310527-10.13918254 0-13.97228671l-53.16888147-53.16888146 82.47359032-82.4735914c3.83310527-3.83310527 3.83310527-10.13918254 0-13.9722878l-45.25537319-44.76077879z"></path></svg>
        <svg v-else-if="type === 'code'" class="icon icon-code" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M974.96412482 8.77812587H49.03587518c-22.26756746 0-40.25775042 17.99018185-40.25774931 40.25774931v925.92824964c0 22.26756746 17.99018185 40.25775042 40.25774931 40.25774931h925.92824964c22.26756746 0 40.25775042-17.99018185 40.25774931-40.25774931V49.03587518c0-22.26756746-17.99018185-40.25775042-40.25774931-40.25774931zM513.38386031 519.67413405l-241.54650028 202.5468044c-6.54188421 5.53544015-16.48051686 0.88063827-16.48051576-7.67413404v-78.88002896c0-2.89352531 1.38386031-5.78705171 3.64835891-7.67413296L397.13960734 512l-138.13440416-115.99264249a9.59895725 9.59895725 0 0 1-3.64835891-7.67413296V309.45319559c0-8.55477234 9.93863154-13.2095742 16.48051576-7.67413404l241.54650028 202.42099972c4.90641344 4.02577515 4.90641344 11.44829764 0 15.47407278zM768.64315573 714.54680441c0 5.53544015-4.27738562 10.06443733-9.43540952 10.06443732h-232.74011748c-5.15802389 0-9.43541061-4.52899718-9.43540951-10.06443732v-60.38662508c0-5.53544015 4.27738562-10.06443733 9.43540951-10.06443733h232.74011748c5.15802389 0 9.43541061 4.52899718 9.43540952 10.06443733v60.38662508z"></path></svg>
        <svg v-else-if="type === 'publish'" class="icon icon-publish" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M569.24228483 811.09716418l277.77768756 120.26399889 135.16213115-900.39427237L37.09452495 586.52335533l247.98251253 117.08166209 599.19371424-544.92070151-481.06689386 600.26284823-6.38647029 255.42613002L569.24228483 811.09716418z" p-id="6297"></path></svg>
    </div>
</template>

<script setup lang="ts">
import { toRefs } from 'vue';
import { open, Command } from '@tauri-apps/api/shell';
import { CODE_APP_LIST } from '../constants/setting';
import { CodeAppItem, AppSettingValue } from '../common/types';
import { getAppSettingData } from '../api/setting';

type ACTION_TYPE = 'demand' | 'ui' | 'api' | 'code' | 'publish';
const props = defineProps<{ type: ACTION_TYPE, value: string }>();
const { type, value } = toRefs(props);

const getShell = async () => {
    const setting: AppSettingValue = await getAppSettingData();
    return CODE_APP_LIST.filter((item: CodeAppItem) => item.value === setting.codeApp)[0].shell;
}

const handleItemClick = async () => {
    if (value === undefined) return;
    if (type.value === 'code') {
        // await open(value.value, '');
        // try {
        //     const shell = await getShell();
        //     const cmd = new Command(shell, ['.'], {
        //         cwd: `${value.value}`,
        //     });
        //     cmd.on('close', data => {
        //         console.log('打开项目成功！');
        //     });
        //     cmd.execute();
        // } catch (error) {
        //     // 使用url打开
        // }
        await open(`vscode://file/${value.value}/`);
        // await open(`jetbrains://web-storm/navigate/reference?path=${value.value}`);
        
    } else {
        await open(value.value);
    }
}
</script>

<style lang="less" scoped>
.v-action-item {
    display: inline-block;
    .icon {
        width: 24px;
        height: 24px;
    }
    .icon-demand {
        fill: @primary;
    }
    .icon-ui {
        fill: @success;
    }
    .icon-api {
        fill: @info;
    }
    .icon-code {
        fill: @warn;
    }
    .icon-publish {
        fill: @danger;
    }
}
</style>